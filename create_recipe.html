<!DOCTYPE html>
<html>
<head>
    <link rel = "stylesheet" type = "text/css" href = "css/style.css">

    <script src="https://www.gstatic.com/firebasejs/5.9.0/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyBrGlVFqo2ixWMzeeq6ppt4jaMErC8H5LY",
            authDomain: "foodle-d4b88.firebaseapp.com",
            databaseURL: "https://foodle-d4b88.firebaseio.com",
            projectId: "foodle-d4b88",
            storageBucket: "foodle-d4b88.appspot.com",
            messagingSenderId: "506441498159"
        };
        firebase.initializeApp(config);
    </script>

    <style>
        #createRecipeHolder {
            padding-left: 23.75%; padding-right: 23.75%;
        }
        textarea {
            border-radius: 1px;
            background-color: rgba(45, 45, 45, 0.60);
            padding: 10px;
            outline: none;
            color: white;
        }
        p {
            color: white;
        }
    </style>
</head>
<body>
    <div>
        <div id = "searchTop">
            <a id = "foodleLogo" class = "unselectable" href = "./index.html"><h1>FOODLE</h1></a>
        </div>

        <br/>

        <div id = "createRecipeHolder">
            <p>Title</p>
            <textarea id = "title" rows = "1" cols = "140"></textarea>
            <p>Cook Time</p>
            <textarea id = "cooktime" rows = "1" cols = "140"></textarea>
            <p>Description</p>
            <textarea id = "description" rows = "6" cols = "140"></textarea>
            <p>Ingredients</p>
            <textarea id = "ingredients" rows = "6" cols = "140"></textarea>
            <p>Steps</p>
            <textarea id = "steps" rows = "6" cols = "140"></textarea>
            <br/><br/>
            <button id = "addRecipeButton">+</button>
        </div> 

        
    <script>

        let addRecipeButton = document.getElementById("addRecipeButton");

        addRecipeButton.addEventListener("click", function (event) {
            writeRecipe();
        });

        function writeRecipe() {
            let title = document.getElementById("title").value;
            let cooktime = document.getElementById("cooktime").value;
            let description = document.getElementById("description").value;
            let ingredients = buildSearchPhraseResult(document.getElementById("ingredients").value);
            let steps = document.getElementById("steps").value;

            if (!title || !description || !ingredients || !steps) {
                window.alert("Empty field!");
            } else {
                let dbref = firebase.database().ref("recipes/" + title).set({
                    "name": title,
                    "cooktime": cooktime,
                    "description": description,
                    "ingredients": ingredients,
                    "steps": steps,
                });

                window.alert("Recipe added!");
            }

            function buildSearchPhraseResult(searchPhrase) {
                searchPhraseList = [];
                searchItem = "";
                for (let i = 0; i < searchPhrase.length; i++) {
                    // Add word to list
                    if (searchPhrase[i] == "#" || searchPhrase[i] == ",") {
                        if (searchItem != "") {
                            searchPhraseList.push(searchItem);
                            searchItem = "";
                        }
                        continue;
                    }
                    // Build word
                    if (searchPhrase[i] != " ") {
                        searchItem += searchPhrase[i];
                    }
                }
                // Last word case
                if (searchItem.length > 0) {
                    searchPhraseList.push(searchItem);
                }
                return searchPhraseList;
            }
        }
        
    </script>
</body>
</html>
